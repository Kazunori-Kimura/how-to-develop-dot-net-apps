# 4. 薬品情報検索システムの開発

<br><br>

## 共通レイアウトの作成

<br><br>

### 用語解説: Bootstrap


<br><br>

## Modelの修正

`Drugs`, `Classifications` に `DisplayName` を設定します。

<br><br>

## Indexの変更

最初に表示される *Index* ページには、検索フォームを追加したいので
自動生成された *アクションメソッド* と *View* を削除し、作り直します。

<br><br>

### ViewModelの作成

自動生成されたソースコードでは、データベースの構造そのままの *Model* と *View* が紐付いており、
*Model* に検索フォームを格納するプロパティがないためにデータの受け渡しが上手くできません。

このような場合、*View* で扱うデータを定義する *ViewModel* を作成します。

`Models/SearchViewModel.cs`

```cs

```

<br><br>

### Index アクションメソッド (GET) の作成

```cs

```

<br><br>

### Index アクションメソッド (POST) の作成

```cs

```

<br><br>

### Index Viewの作成

```html

```

<br><br>

#### 新規登録リンク

`ActionLink`

<br><br>

#### 検索フォームの表示

```cs
@Html.DropDownList("ClassificationId", null, htmlAttributes: new { @class = "form-control" })
```

[DropDownList](https://msdn.microsoft.com/ja-jp/library/system.web.mvc.html.selectextensions.dropdownlist.aspx) は第2引数に `null` を渡した場合、 `ViewBag` に 第1引数と同じキーの項目があれば、それをセットしてくれます。

<br><br>

#### 検索結果の表示

`Create`, `Details`, `Edit` を選択した場合の処理


<br><br>

## Detailsの変更

自動生成されたソースコードでは、薬効分類コードのみ表示されています。  
薬効分類の名称を表示するように *View* を修正します。

<br><br>

## Createの変更

<br><br>

## Editの変更

自動生成されたソースコードでは、コンボボックスに薬効分類コードのみ表示されています。  
薬効分類の名称を表示するようにコントローラーの処理を修正します。

<br><br>

### Controllerの変更

*View* では自動生成されたソースコードのまま `DropDownList` を使用し、
コントローラー側で `ViewBag` に コンボボックスの選択肢と初期選択値をセットします。

<br><br>

### Viewの変更

自動生成されたソースコードで `DropDownListFor` を使用していないのは、初期選択値を渡せないためです。

* 参考: [DropDownListFor と ViewBag を組み合わせた時の問題](http://blog.shibayan.jp/entry/20130207/1360226954)

<br><br>

## Deleteの変更

### Viewの変更

<br><br>
